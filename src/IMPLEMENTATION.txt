// PROCESS.txt

#######
Domain
#######

ObjectInstance: Represents a specific object on the canvas.
PropertyInstance: Represents a property on an object instance.
CanvasObject: An object on the canvas, provided by the rendering library.
PropertySetter: A function that sets a property on a canvas object.

#######
Process
#######

---
GetRootObjects - Retrieves the root objects from the project.
--->


--->
ExtractPropertyPaths - Extracts property paths from the object hierarchy.
    - Objects
--->
for object in objects:
    for property in object.properties:
        yield PropertyPath(object, property)
    for component in object.components:
        for property in component.properties:
            yield PropertyPath(object, component, property)
        for child in component.children:
            for property in child.properties:
                yield PropertyPath(object, component, child, property)
--->


--->
AnnotateCloneCounts - Annotates property paths with clone counts.
    - CloneCountPropertyPaths
    - NonCloneCountPropertyPaths
--->
CloneCountResults =
    for path in CloneCountPropertyPaths:
        count = EvaluateCloneCount(path)
        yield CloneCountResult(path, count)

yield AnnotatedPropertyPaths =
    for path in NonCloneCountPropertyPaths:
        annotatedSegments =
            for segment in path:
                yield AnnotatedSegment(segment, CloneCountResults)
        yield AnnotatedPropertyPath(annotatedSegments)            


---
ExpandPropertyPaths - Converts PropertyPaths to PropertyInstancePaths by expanding clone counts.
    - AnnotatedPropertyPaths
--->
yield PropertyInstancePaths = for path in AnnotatedPropertyPaths:
    segments = PathSegments(path)
    for instance in ExpandPath(segments):
        yield instance

function ExpandPath(PathSegments):
    if PathSegments.length == 1:
        return yield PathSegments[0]

    first, rest = PathSegments[0], PathSegments[1:]
    yield* ExpandPathSegment(first)
    yield* ExpandPath(rest)

function ExpandPathSegment(PathSegment):
    if PathSegment.hasCloneCount:
        for i in range(PathSegment.count):
            yield PathSegment.clone(i)
    else:
        yield PathSegment

---
EvaluatePropertyInstances - Evaluates property instance paths to compute their corresponding values.
--->



---
GroupObjectInstances - Nests property results into their object instances.
--->



---
AcquireCanvasObjects - Acquires CanvasObjects for each object instance.
--->



---
ExtractCanvasProperties - Extracts individual properties from library canvas objects for further processing.
--->



---
MapPropertySetters - Maps extracted properties to their corresponding setter functions.
    - needs GetPropertySetter(property)
--->



---
ExecutePropertySetters - Applies the setter functions to update the properties on library canvas objects.
---

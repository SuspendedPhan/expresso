{"remainingRequest":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/Expressor.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/Expressor.vue","mtime":1714946187070},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js","mtime":1714947394795},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js","mtime":1714947393584}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFBlblBvc2l0aW9uUmVsYXRpb24gfSBmcm9tICJAL3N0b3JlL1BlbiI7CmltcG9ydCB3dSBmcm9tICJ3dSI7CmltcG9ydCBSb290IGZyb20gIi4uL3N0b3JlL1Jvb3QiOwppbXBvcnQgTm9kZSBmcm9tICIuL05vZGUiOwppbXBvcnQgT3JnYW5pc20gZnJvbSAiLi9PcmdhbmlzbSI7CmltcG9ydCBWdWUgZnJvbSAidnVlIjsKaW1wb3J0IHBhbnpvb20gZnJvbSAicGFuem9vbSI7CmltcG9ydCBDb21wb25lbnQgZnJvbSAidnVlLWNsYXNzLWNvbXBvbmVudCI7CmltcG9ydCB7IFByb3AgfSBmcm9tICJ2dWUtcHJvcGVydHktZGVjb3JhdG9yIjsKaW1wb3J0IFJlc2l6ZVNlbnNvciBmcm9tICJjc3MtZWxlbWVudC1xdWVyaWVzL3NyYy9SZXNpemVTZW5zb3IiOwoKQENvbXBvbmVudCh7CiAgY29tcG9uZW50czogewogICAgLy8gTm9kZSwKICAgIE9yZ2FuaXNtLAogIH0sCn0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV4cHJlc3NvciBleHRlbmRzIFZ1ZSB7CiAgcm9vdCA9IFJvb3Q7CiAgYXR0cmlidXRlU3RvcmUgPSBSb290LmF0dHJpYnV0ZVN0b3JlOwogIG1ldGFvcmdhbmlzbUNvbGxlY3Rpb24gPSBSb290Lm1ldGFvcmdhbmlzbUNvbGxlY3Rpb247CiAgc2VsZWN0ZWRQcmltaXRpdmVJZCA9IFJvb3QubWV0YW9yZ2FuaXNtQ29sbGVjdGlvbi5nZXRNZXRhb3JnYW5pc21zKClbMF0uaWQ7CiAgY29uc29sZUVycm9yID0gZmFsc2U7CiAgY2FudmFzV2lkdGggPSAwOwogIGNhbnZhc0hlaWdodCA9IDA7CiAgcGFuem9vbVRyYW5zZm9ybSA9IHt9OwogIGxpbmVzID0gW107CgogIGJveCA9IHsKICAgIHdpZHRoOiAwLAogICAgaGVpZ2h0OiAwCiAgfQoKICBnZXQgYm94U3R5bGUoKSB7CiAgICBjb25zb2xlLmxvZygiZ2V0IHN0eWxlIik7CiAgICBjb25zb2xlLmxvZyh0aGlzLmJveC53aWR0aCk7CiAgICByZXR1cm4gYGxlZnQ6IDBweDsgd2lkdGg6ICR7dGhpcy5ib3gud2lkdGh9cHg7IGhlaWdodDogJHt0aGlzLmJveC5oZWlnaHR9cHhgOwogIH0KCiAgZ2V0Tm9kZUZvckF0dHJpYnV0ZShhdHRyaWJ1dGUpIHsKICAgIHJldHVybiBSb290Lm5vZGVTdG9yZS5nZXRDaGlsZCgKICAgICAgUm9vdC5hdHRyaWJ1dGVTdG9yZS5nZXRSb290Tm9kZShhdHRyaWJ1dGUpLAogICAgICAwCiAgICApOwogIH0KCiAgc3Bhd24oKSB7CiAgICBjb25zdCBtZXRhb3JnYW5pc20gPSB0aGlzLm1ldGFvcmdhbmlzbUNvbGxlY3Rpb24uZ2V0RnJvbUlkKAogICAgICB0aGlzLnNlbGVjdGVkUHJpbWl0aXZlSWQKICAgICk7CiAgICB0aGlzLnJvb3Qub3JnYW5pc21Db2xsZWN0aW9uLnB1dEZyb21NZXRhKHVuZGVmaW5lZCwgbWV0YW9yZ2FuaXNtKTsKICAgIHRoaXMucm9vdC5zYXZlKCk7CiAgfQoKICBjbGVhclN0b3JhZ2UoKSB7CiAgICB0aGlzLnJvb3QuY2xlYXJTdG9yYWdlKCk7CiAgfQoKICByZW1vdmVPcmdhbmlzbShvcmdhbmlzbSkgewogICAgdGhpcy5yb290Lm9yZ2FuaXNtQ29sbGVjdGlvbi5yZW1vdmUob3JnYW5pc20pOwogICAgdGhpcy5yb290LnNhdmUoKTsKICB9CgogIGRyYXdMaW5lcygpIHsKICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLiRyZWZzWyJjYW52YXMiXS5nZXRDb250ZXh0KCIyZCIpOwogICAgY29udGV4dC5yZXNldFRyYW5zZm9ybSgpOwogICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXNXaWR0aCwgdGhpcy5jYW52YXNIZWlnaHQpOwogICAgY29uc3QgdHJhbnNmb3JtID0gdGhpcy5wYW56b29tVHJhbnNmb3JtOwogICAgY29udGV4dC5zZXRUcmFuc2Zvcm0oCiAgICAgIHRyYW5zZm9ybS5zY2FsZSwKICAgICAgMCwKICAgICAgMCwKICAgICAgdHJhbnNmb3JtLnNjYWxlLAogICAgICB0cmFuc2Zvcm0ueCwKICAgICAgdHJhbnNmb3JtLnkKICAgICk7CiAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gImdyYXkiOwogICAgZm9yIChjb25zdCBsaW5lIG9mIHRoaXMubGluZXMpIHsKICAgICAgY29udGV4dC5iZWdpblBhdGgoKTsKICAgICAgY29udGV4dC5tb3ZlVG8obGluZS5zdGFydFgsIGxpbmUuc3RhcnRZKTsKICAgICAgY29udGV4dC5saW5lVG8obGluZS5lbmRYLCBsaW5lLmVuZFkpOwogICAgICBjb250ZXh0LnN0cm9rZSgpOwogICAgfQogIH0KCiAgbW91bnRlZCgpIHsKICAgIGNvbnN0IHB6ID0gcGFuem9vbSh0aGlzLiRyZWZzWyJwYW56b29tIl0sIHsKICAgICAgYmVmb3JlTW91c2VEb3duOiBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBzaG91bGRJZ25vcmUgPSAhZS5hbHRLZXk7CiAgICAgICAgcmV0dXJuIHNob3VsZElnbm9yZTsKICAgICAgfSwKICAgICAgZmlsdGVyS2V5OiBmdW5jdGlvbiAoLyogZSwgZHgsIGR5LCBkeiAqLykgewogICAgICAgIC8vIGRvbid0IGxldCBwYW56b29tIGhhbmRsZSB0aGlzIGV2ZW50OgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICB6b29tRG91YmxlQ2xpY2tTcGVlZDogMSwKICAgIH0pOwogICAgcHoub24oInRyYW5zZm9ybSIsIChlKSA9PiB7CiAgICAgIHRoaXMucGFuem9vbVRyYW5zZm9ybSA9IHB6LmdldFRyYW5zZm9ybSgpOwogICAgICB0aGlzLmRyYXdMaW5lcygpOwogICAgfSk7CgogICAgLy8gTk9URTogbWF5YmUgY2FuIHJlbW92ZT8KICAgIHRoaXMuY2FudmFzV2lkdGggPSB0aGlzLiRyZWZzWyJleHByZXNzb3IiXS5jbGllbnRXaWR0aDsKICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy4kcmVmc1siZXhwcmVzc29yIl0uY2xpZW50SGVpZ2h0OwoKICAgIG5ldyBSZXNpemVTZW5zb3IodGhpcy4kcmVmc1siZXhwcmVzc29yIl0sICgpID0+IHsKICAgICAgdGhpcy5jYW52YXNXaWR0aCA9IHRoaXMuJHJlZnNbImV4cHJlc3NvciJdLmNsaWVudFdpZHRoOwogICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuJHJlZnNbImV4cHJlc3NvciJdLmNsaWVudEhlaWdodDsKICAgIH0pOwoKICAgIHRoaXMucm9vdC5vcmdhbmlzbUxheW91dC5vbkNhbGN1bGF0ZWQuc3Vic2NyaWJlKChvdXRwdXQpID0+IHsKICAgICAgdGhpcy5saW5lcyA9IG91dHB1dC5saW5lczsKICAgICAgdGhpcy5ib3gud2lkdGggPSBvdXRwdXQudG90YWxXaWR0aDsKICAgICAgdGhpcy5ib3guaGVpZ2h0ID0gb3V0cHV0LnRvdGFsSGVpZ2h0OwogICAgICB0aGlzLmRyYXdMaW5lcygpOwogICAgfSk7CiAgfQp9Cg=="},{"version":3,"sources":["Expressor.vue"],"names":[],"mappings":";AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Expressor.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"expressor\" ref=\"expressor\">\n    <canvas\n      ref=\"canvas\"\n      type=\"2d\"\n      :width=\"canvasWidth\"\n      :height=\"canvasHeight\"\n      class=\"canvas\"\n    ></canvas>\n    <div ref=\"panzoom\">\n      <Organism :organism=\"root.organismCollection.getRoot()\" :isRoot=\"true\" />\n      <div class=\"absolute border-solid border-2\" :style=\"boxStyle\"></div>\n      <div class=\"bottom-group\">\n        <button @click=\"clearStorage\" class=\"clearStorage\">\n          Clear storage\n        </button>\n        <div :class=\"['error-box', { error: consoleError }]\">\n          you have console errors\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { PenPositionRelation } from \"@/store/Pen\";\nimport wu from \"wu\";\nimport Root from \"../store/Root\";\nimport Node from \"./Node\";\nimport Organism from \"./Organism\";\nimport Vue from \"vue\";\nimport panzoom from \"panzoom\";\nimport Component from \"vue-class-component\";\nimport { Prop } from \"vue-property-decorator\";\nimport ResizeSensor from \"css-element-queries/src/ResizeSensor\";\n\n@Component({\n  components: {\n    // Node,\n    Organism,\n  },\n})\nexport default class Expressor extends Vue {\n  root = Root;\n  attributeStore = Root.attributeStore;\n  metaorganismCollection = Root.metaorganismCollection;\n  selectedPrimitiveId = Root.metaorganismCollection.getMetaorganisms()[0].id;\n  consoleError = false;\n  canvasWidth = 0;\n  canvasHeight = 0;\n  panzoomTransform = {};\n  lines = [];\n\n  box = {\n    width: 0,\n    height: 0\n  }\n\n  get boxStyle() {\n    console.log(\"get style\");\n    console.log(this.box.width);\n    return `left: 0px; width: ${this.box.width}px; height: ${this.box.height}px`;\n  }\n\n  getNodeForAttribute(attribute) {\n    return Root.nodeStore.getChild(\n      Root.attributeStore.getRootNode(attribute),\n      0\n    );\n  }\n\n  spawn() {\n    const metaorganism = this.metaorganismCollection.getFromId(\n      this.selectedPrimitiveId\n    );\n    this.root.organismCollection.putFromMeta(undefined, metaorganism);\n    this.root.save();\n  }\n\n  clearStorage() {\n    this.root.clearStorage();\n  }\n\n  removeOrganism(organism) {\n    this.root.organismCollection.remove(organism);\n    this.root.save();\n  }\n\n  drawLines() {\n    const context = this.$refs[\"canvas\"].getContext(\"2d\");\n    context.resetTransform();\n    context.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n    const transform = this.panzoomTransform;\n    context.setTransform(\n      transform.scale,\n      0,\n      0,\n      transform.scale,\n      transform.x,\n      transform.y\n    );\n    context.strokeStyle = \"gray\";\n    for (const line of this.lines) {\n      context.beginPath();\n      context.moveTo(line.startX, line.startY);\n      context.lineTo(line.endX, line.endY);\n      context.stroke();\n    }\n  }\n\n  mounted() {\n    const pz = panzoom(this.$refs[\"panzoom\"], {\n      beforeMouseDown: function (e) {\n        var shouldIgnore = !e.altKey;\n        return shouldIgnore;\n      },\n      filterKey: function (/* e, dx, dy, dz */) {\n        // don't let panzoom handle this event:\n        return true;\n      },\n      zoomDoubleClickSpeed: 1,\n    });\n    pz.on(\"transform\", (e) => {\n      this.panzoomTransform = pz.getTransform();\n      this.drawLines();\n    });\n\n    // NOTE: maybe can remove?\n    this.canvasWidth = this.$refs[\"expressor\"].clientWidth;\n    this.canvasHeight = this.$refs[\"expressor\"].clientHeight;\n\n    new ResizeSensor(this.$refs[\"expressor\"], () => {\n      this.canvasWidth = this.$refs[\"expressor\"].clientWidth;\n      this.canvasHeight = this.$refs[\"expressor\"].clientHeight;\n    });\n\n    this.root.organismLayout.onCalculated.subscribe((output) => {\n      this.lines = output.lines;\n      this.box.width = output.totalWidth;\n      this.box.height = output.totalHeight;\n      this.drawLines();\n    });\n  }\n}\n</script>\n\n<style scoped>\n.expressor {\n  position: relative;\n  outline: none;\n}\n.organism {\n  margin-bottom: 20px;\n}\n.attribute {\n}\n.controls {\n  display: grid;\n  grid-template-columns: max-content max-content max-content;\n  gap: 10px;\n}\n.bottom-group {\n  display: flex;\n  justify-content: space-between;\n}\n.error-box {\n  padding: 5px;\n  font-size: 12px;\n  background-color: hsl(0, 100%, 67%);\n  visibility: hidden;\n  color: white;\n}\n.error-box.error {\n  visibility: visible;\n}\n.canvas {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0px;\n  left: 0px;\n  border: none;\n}\n.clearStorage {\n  position: fixed;\n  top: 10px;\n  left: 200px;\n  z-index: 2;\n}\n</style>\n"]}]}
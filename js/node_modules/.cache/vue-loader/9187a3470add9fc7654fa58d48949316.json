{"remainingRequest":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/Attribute.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/Attribute.vue","mtime":1714946187069},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js","mtime":1714947394795},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js","mtime":1714947393584}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBWdWUgZnJvbSAidnVlIjsKaW1wb3J0IENvbXBvbmVudCBmcm9tICJ2dWUtY2xhc3MtY29tcG9uZW50IjsKaW1wb3J0IHsgUHJvcCwgV2F0Y2ggfSBmcm9tICJ2dWUtcHJvcGVydHktZGVjb3JhdG9yIjsKaW1wb3J0IFJvb3QgZnJvbSAiLi4vc3RvcmUvUm9vdCI7CmltcG9ydCBOb2RlUGlja2VyIGZyb20gIi4vTm9kZVBpY2tlciI7CmltcG9ydCBJbmxpbmVJbnB1dCBmcm9tICIuL0lubGluZUlucHV0IjsKaW1wb3J0IFF1aWxsIGZyb20gInF1aWxsIjsKaW1wb3J0IEF0dHJpYnV0ZU1vZGVsIGZyb20gIkAvbW9kZWxzL0F0dHJpYnV0ZSI7CgpAQ29tcG9uZW50KHsKICBjb21wb25lbnRzOiB7IE5vZGVQaWNrZXIsIElubGluZUlucHV0IH0sCn0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF0dHJpYnV0ZSBleHRlbmRzIFZ1ZSB7CiAgQFByb3AoKSBhc3ROb2RlOwogIEBQcm9wKCkgYXR0cmlidXRlTW9kZWw7CgogIHF1aWxsID0gbnVsbDsKICBwZW4gPSBSb290LnBlblN0b3JlOwoKICBtb3VudGVkKCkgewogICAgUXVpbGwucmVnaXN0ZXIoUXVpbGwuaW1wb3J0KCJhdHRyaWJ1dG9ycy9jbGFzcy9jb2xvciIpLCB0cnVlKTsKICAgIFF1aWxsLnJlZ2lzdGVyKFF1aWxsLmltcG9ydCgiYXR0cmlidXRvcnMvY2xhc3MvYmFja2dyb3VuZCIpLCB0cnVlKTsKICAgIHZhciBiaW5kaW5ncyA9IHsKICAgICAgLy8gVGhpcyB3aWxsIG92ZXJ3cml0ZSB0aGUgZGVmYXVsdCBiaW5kaW5nIGFsc28gbmFtZWQgJ3RhYicKICAgICAgZW50ZXI6IHsKICAgICAgICBrZXk6IDEzLAogICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHN1cHByZXNzCiAgICAgICAgfSwKICAgICAgfSwKICAgIH07CiAgICB0aGlzLnF1aWxsID0gbmV3IFF1aWxsKHRoaXMuJHJlZnNbInRleHRhcmVhIl0sIHsKICAgICAgbW9kdWxlczogewogICAgICAgIGtleWJvYXJkOiB7CiAgICAgICAgICBiaW5kaW5nczogYmluZGluZ3MsCiAgICAgICAgfSwKICAgICAgfSwKICAgIH0pOwogICAgdGhpcy5xdWlsbC5yb290LnNldEF0dHJpYnV0ZSgic3BlbGxjaGVjayIsIGZhbHNlKTsKCiAgICB0aGlzLnNldFRleHQodGhpcy5xdWlsbCwgdGhpcy5nZXRUZXh0KDEpKTsKCiAgICB0aGlzLnF1aWxsLnJvb3QuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIChldmVudCkgPT4gewogICAgICBpZiAoZXZlbnQua2V5Lmxlbmd0aCA9PT0gMSAmJiAhZXZlbnQuY3RybEtleSAmJiAhZXZlbnQuYWx0S2V5KSB7CiAgICAgICAgdGhpcy5wZW4uc2V0SXNRdWVyeWluZyh0cnVlKTsKICAgICAgICB0aGlzLnBlbi5zZXRRdWVyeShldmVudC5rZXkpOwogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAiRW50ZXIiKSB7CiAgICAgICAgdGhpcy5wZW4uc2V0SXNRdWVyeWluZyh0cnVlKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gInIiICYmIGV2ZW50LmFsdEtleSkgewogICAgICAgIGlmICghUm9vdC5wZW4uaXNDdXJzb3JJbnNlcnRpbmcoKSkgewogICAgICAgICAgUm9vdC5wZW4udHJ5UHJvbW90ZVNlbGVjdGlvblRvUm9vdCgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09ICJhIiAmJiBldmVudC5hbHRLZXkpIHsKICAgICAgICBSb290Lm5vZGVDb2xsZWN0aW9uLmNvbnZlcnRUb0F0dHJpYnV0ZShSb290LnBlbi5nZXRQb2ludGVkTm9kZSgpKTsKICAgICAgICBSb290LnNhdmUoKTsKICAgICAgICB0aGlzLnVwZGF0ZUVkaXRvcklmU2VsZWN0ZWQoKTsKICAgICAgfQogICAgfSk7CgogICAgdGhpcy5xdWlsbC5vbigidGV4dC1jaGFuZ2UiLCAoZGVsdGEsIG9sZERlbHRhLCBzb3VyY2UpID0+IHsKICAgICAgaWYgKHNvdXJjZSAhPT0gInVzZXIiKSByZXR1cm47CiAgICAgIFZ1ZS5uZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5zZXRUZXh0KHRoaXMucXVpbGwsIG9sZERlbHRhLm9wc1swXS5pbnNlcnQpOwogICAgICB9KTsKICAgIH0pOwoKICAgIHRoaXMucXVpbGwub24oInNlbGVjdGlvbi1jaGFuZ2UiLCAocmFuZ2UsIG9sZFJhbmdlLCBzb3VyY2UpID0+IHsKICAgICAgaWYgKHNvdXJjZSAhPT0gInVzZXIiKSByZXR1cm47CiAgICAgIGlmICh0aGlzLnBlbi5nZXRJc1F1ZXJ5aW5nKCkpIHJldHVybjsKCiAgICAgIGlmIChyYW5nZSA9PT0gbnVsbCkgewogICAgICAgIHRoaXMucGVuLnNldFNlbGVjdGlvbihudWxsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBlbi5zZXRTZWxlY3Rpb24oewogICAgICAgICAgYXR0cmlidXRlSWQ6IHRoaXMuYXR0cmlidXRlTW9kZWwuaWQsCiAgICAgICAgICBzdGFydEluZGV4OiByYW5nZS5pbmRleCwKICAgICAgICAgIGVuZEluZGV4OiByYW5nZS5pbmRleCArIHJhbmdlLmxlbmd0aCwKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgdGhpcy5wZW4uZXZlbnRzLm9uKCJhZnRlclBlbkNvbW1pdCIsICgpID0+IHRoaXMudXBkYXRlRWRpdG9ySWZTZWxlY3RlZCgpKTsKCiAgICBBdHRyaWJ1dGVNb2RlbC5vblNvbWVBdHRyaWJ1dGVDaGFuZ2VkLnN1YigoKSA9PiB0aGlzLnVwZGF0ZUVkaXRvcigpKTsKICB9CgogIGJsdXIoKSB7CiAgICB0aGlzLnF1aWxsLmZvY3VzKCk7CiAgfQoKICByZW1vdmUoKSB7CiAgICB0aGlzLmF0dHJpYnV0ZU1vZGVsLmlubGluZVdpdGhEZWZhdWx0cygpOwogICAgUm9vdC5zYXZlKCk7CiAgfQoKICBzdGFydEVkaXRpbmdOYW1lKCkgewogICAgaWYgKCF0aGlzLmF0dHJpYnV0ZU1vZGVsLmlzRnJvemVuKSB7CiAgICAgIHRoaXMuaW5wdXROYW1lID0gdGhpcy5hdHRyaWJ1dGVNb2RlbC5uYW1lOwogICAgICB0aGlzLmlzRWRpdGluZ05hbWUgPSB0cnVlOwogICAgICBWdWUubmV4dFRpY2soKCkgPT4gdGhpcy4kcmVmc1sibmFtZUlucHV0Il0uZm9jdXMoKSk7CiAgICB9CiAgfQoKICBjb21taXROYW1lKCkgewogICAgdGhpcy5hdHRyaWJ1dGVNb2RlbC5uYW1lID0gdGhpcy5pbnB1dE5hbWU7CiAgICB0aGlzLmlzRWRpdGluZ05hbWUgPSBmYWxzZTsKICB9CgogIG9uSW5wdXRLZXlwcmVzcyhldmVudCkgewogICAgaWYgKGV2ZW50LmtleSA9PT0gIkVudGVyIikgewogICAgICB0aGlzLmNvbW1pdE5hbWUoKTsKICAgIH0KICB9CgogIG9uSW5wdXRCbHVyKCkgewogICAgdGhpcy5pc0VkaXRpbmdOYW1lID0gZmFsc2U7CiAgfQoKICBvbk5hbWVDaGFuZ2UodmFsdWUpIHsKICAgIHRoaXMuYXR0cmlidXRlTW9kZWwubmFtZSA9IHZhbHVlOwogICAgUm9vdC5zYXZlKCk7CiAgfQoKICBAV2F0Y2goInBpY2tpbmciKQogIGZvY3VzU2VhcmNoZXIoKSB7CiAgICBpZiAodGhpcy5waWNraW5nKSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKCkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sic2VhcmNoZXIiXS5mb2N1cygpOwogICAgICB9KTsKICAgIH0KICB9CgogIGdldCBwaWNraW5nKCkgewogICAgcmV0dXJuICgKICAgICAgUm9vdC5wZW5TdG9yZS5nZXRJc1F1ZXJ5aW5nKCkgJiYKICAgICAgUm9vdC5wZW4uZ2V0U2VsZWN0ZWRBdHRyaWJ1dGUoKSA9PT0gdGhpcy5hdHRyaWJ1dGVNb2RlbAogICAgKTsKICB9CgogIHVwZGF0ZUVkaXRvcigpIHsKICAgIGlmIChBdHRyaWJ1dGVNb2RlbC5hdHRyaWJ1dGVzLmluZGV4T2YodGhpcy5hdHRyaWJ1dGVNb2RlbCkgIT09IC0xKSB7CiAgICAgIHRoaXMuc2V0VGV4dCh0aGlzLnF1aWxsLCB0aGlzLmdldFRleHQoKSk7CiAgICB9CiAgfQoKICB1cGRhdGVFZGl0b3JJZlNlbGVjdGVkKCkgewogICAgaWYgKHRoaXMucGVuLmdldFNlbGVjdGVkQXR0cmlidXRlKCkgIT09IHRoaXMuYXR0cmlidXRlTW9kZWwpIHJldHVybjsKICAgIHRoaXMudXBkYXRlRWRpdG9yKCk7CiAgfQoKICBzZXRUZXh0KHF1aWxsLCB0ZXh0KSB7CiAgICB0aGlzLnF1aWxsLnJlbW92ZUZvcm1hdCgwLCB0aGlzLnF1aWxsLmdldExlbmd0aCgpKTsKICAgIHRoaXMucXVpbGwuc2V0VGV4dCh0ZXh0LCAic2lsZW50Iik7CiAgICBjb25zdCBhbm5vdGF0ZWRUZXh0ID0gUm9vdC5wZW4uZ2V0QW5ub3RhdGVkVGV4dEZvckF0dHJpYnV0ZSgKICAgICAgdGhpcy5hdHRyaWJ1dGVNb2RlbAogICAgKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFubm90YXRlZFRleHQubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYW5ub3RhdGVkQ2hhciA9IGFubm90YXRlZFRleHRbaV07CiAgICAgIGNvbnN0IG5vZGUgPSBhbm5vdGF0ZWRDaGFyLm5vZGU7CiAgICAgIGlmIChub2RlID09PSBudWxsKSBjb250aW51ZTsKICAgICAgaWYgKG5vZGUubWV0YW5hbWUgPT09ICJGdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLnF1aWxsLmZvcm1hdFRleHQoaSwgMSwgImNvbG9yIiwgImZ1bmN0aW9uIiwgInNpbGVudCIpOwogICAgICB9IGVsc2UgaWYgKG5vZGUubWV0YW5hbWUgIT09ICJOdW1iZXIiICYmIG5vZGUubWV0YW5hbWUgIT09ICJWZWN0b3IiKSB7CiAgICAgICAgdGhpcy5xdWlsbC5mb3JtYXRUZXh0KGksIDEsICJjb2xvciIsICJ2YXJpYWJsZSIsICJzaWxlbnQiKTsKICAgICAgfQogICAgfQogICAgdGhpcy51cGRhdGVDdXJzb3IoKTsKICB9CgogIEBXYXRjaCgicGVuLnNlbGVjdGlvbiIpCiAgdXBkYXRlQ3Vyc29yKCkgewogICAgaWYgKHRoaXMucGVuLmdldElzUXVlcnlpbmcoKSkgcmV0dXJuOwoKICAgIHRoaXMucXVpbGwuZm9ybWF0VGV4dCgKICAgICAgMCwKICAgICAgdGhpcy5xdWlsbC5nZXRMZW5ndGgoKSwKICAgICAgImJhY2tncm91bmQiLAogICAgICBmYWxzZSwKICAgICAgInNpbGVudCIKICAgICk7CgogICAgaWYgKHRoaXMucGVuLmdldFNlbGVjdGlvbigpPy5hdHRyaWJ1dGVJZCA9PT0gdGhpcy5hdHRyaWJ1dGVNb2RlbC5pZCkgewogICAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLnBlbi5nZXRTZWxlY3Rpb24oKTsKICAgICAgdGhpcy5xdWlsbC5zZXRTZWxlY3Rpb24oCiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0SW5kZXgsCiAgICAgICAgc2VsZWN0aW9uLmVuZEluZGV4IC0gc2VsZWN0aW9uLnN0YXJ0SW5kZXgsCiAgICAgICAgInNpbGVudCIKICAgICAgKTsKICAgICAgY29uc3QgbGVuZ3RoID0gc2VsZWN0aW9uLmVuZEluZGV4IC0gc2VsZWN0aW9uLnN0YXJ0SW5kZXg7CgogICAgICB0aGlzLnF1aWxsLmZvcm1hdFRleHQoCiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0SW5kZXgsCiAgICAgICAgbGVuZ3RoLAogICAgICAgICJiYWNrZ3JvdW5kIiwKICAgICAgICAic2VsZWN0ZWQiLAogICAgICAgICJzaWxlbnQiCiAgICAgICk7CiAgICB9CiAgfQoKICBnZXRUZXh0KCkgewogICAgcmV0dXJuIFJvb3QucGVuLmdldFRleHRGb3JBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVNb2RlbCk7CiAgfQp9Cg=="},{"version":3,"sources":["Attribute.vue"],"names":[],"mappings":";AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Attribute.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <div class=\"flex flex-col space-y-2\">\n      <div class=\"flex justify-between\">\n        <InlineInput\n          :value='attributeModel.name'\n          @input='onNameChange'\n          :readonly=\"attributeModel.isFrozen\"\n        >\n          <span class=\"text-attribute\">{{ attributeModel.name }}</span>\n        </InlineInput>\n        <button v-if=\"!attributeModel.isFrozen\" @click=\"remove\">Remove</button>\n      </div>\n      <div ref=\"textarea\"></div>\n    </div>\n    <NodePicker\n      ref=\"searcher\"\n      v-if=\"picking\"\n      @blur=\"blur\"\n      :class=\"['searcher', { 'bring-to-front': picking }]\"\n    />\n  </div>\n</template>\n\n<script>\nimport Vue from \"vue\";\nimport Component from \"vue-class-component\";\nimport { Prop, Watch } from \"vue-property-decorator\";\nimport Root from \"../store/Root\";\nimport NodePicker from \"./NodePicker\";\nimport InlineInput from \"./InlineInput\";\nimport Quill from \"quill\";\nimport AttributeModel from \"@/models/Attribute\";\n\n@Component({\n  components: { NodePicker, InlineInput },\n})\nexport default class Attribute extends Vue {\n  @Prop() astNode;\n  @Prop() attributeModel;\n\n  quill = null;\n  pen = Root.penStore;\n\n  mounted() {\n    Quill.register(Quill.import(\"attributors/class/color\"), true);\n    Quill.register(Quill.import(\"attributors/class/background\"), true);\n    var bindings = {\n      // This will overwrite the default binding also named 'tab'\n      enter: {\n        key: 13,\n        handler: function () {\n          // suppress\n        },\n      },\n    };\n    this.quill = new Quill(this.$refs[\"textarea\"], {\n      modules: {\n        keyboard: {\n          bindings: bindings,\n        },\n      },\n    });\n    this.quill.root.setAttribute(\"spellcheck\", false);\n\n    this.setText(this.quill, this.getText(1));\n\n    this.quill.root.addEventListener(\"keydown\", (event) => {\n      if (event.key.length === 1 && !event.ctrlKey && !event.altKey) {\n        this.pen.setIsQuerying(true);\n        this.pen.setQuery(event.key);\n        event.preventDefault();\n        event.stopPropagation();\n      } else if (event.key === \"Enter\") {\n        this.pen.setIsQuerying(true);\n        event.preventDefault();\n        event.stopPropagation();\n      } else if (event.key === \"r\" && event.altKey) {\n        if (!Root.pen.isCursorInserting()) {\n          Root.pen.tryPromoteSelectionToRoot();\n        }\n      } else if (event.key === \"a\" && event.altKey) {\n        Root.nodeCollection.convertToAttribute(Root.pen.getPointedNode());\n        Root.save();\n        this.updateEditorIfSelected();\n      }\n    });\n\n    this.quill.on(\"text-change\", (delta, oldDelta, source) => {\n      if (source !== \"user\") return;\n      Vue.nextTick(() => {\n        this.setText(this.quill, oldDelta.ops[0].insert);\n      });\n    });\n\n    this.quill.on(\"selection-change\", (range, oldRange, source) => {\n      if (source !== \"user\") return;\n      if (this.pen.getIsQuerying()) return;\n\n      if (range === null) {\n        this.pen.setSelection(null);\n      } else {\n        this.pen.setSelection({\n          attributeId: this.attributeModel.id,\n          startIndex: range.index,\n          endIndex: range.index + range.length,\n        });\n      }\n    });\n\n    this.pen.events.on(\"afterPenCommit\", () => this.updateEditorIfSelected());\n\n    AttributeModel.onSomeAttributeChanged.sub(() => this.updateEditor());\n  }\n\n  blur() {\n    this.quill.focus();\n  }\n\n  remove() {\n    this.attributeModel.inlineWithDefaults();\n    Root.save();\n  }\n\n  startEditingName() {\n    if (!this.attributeModel.isFrozen) {\n      this.inputName = this.attributeModel.name;\n      this.isEditingName = true;\n      Vue.nextTick(() => this.$refs[\"nameInput\"].focus());\n    }\n  }\n\n  commitName() {\n    this.attributeModel.name = this.inputName;\n    this.isEditingName = false;\n  }\n\n  onInputKeypress(event) {\n    if (event.key === \"Enter\") {\n      this.commitName();\n    }\n  }\n\n  onInputBlur() {\n    this.isEditingName = false;\n  }\n\n  onNameChange(value) {\n    this.attributeModel.name = value;\n    Root.save();\n  }\n\n  @Watch(\"picking\")\n  focusSearcher() {\n    if (this.picking) {\n      this.$nextTick().then(() => {\n        this.$refs[\"searcher\"].focus();\n      });\n    }\n  }\n\n  get picking() {\n    return (\n      Root.penStore.getIsQuerying() &&\n      Root.pen.getSelectedAttribute() === this.attributeModel\n    );\n  }\n\n  updateEditor() {\n    if (AttributeModel.attributes.indexOf(this.attributeModel) !== -1) {\n      this.setText(this.quill, this.getText());\n    }\n  }\n\n  updateEditorIfSelected() {\n    if (this.pen.getSelectedAttribute() !== this.attributeModel) return;\n    this.updateEditor();\n  }\n\n  setText(quill, text) {\n    this.quill.removeFormat(0, this.quill.getLength());\n    this.quill.setText(text, \"silent\");\n    const annotatedText = Root.pen.getAnnotatedTextForAttribute(\n      this.attributeModel\n    );\n\n    for (let i = 0; i < annotatedText.length; i++) {\n      const annotatedChar = annotatedText[i];\n      const node = annotatedChar.node;\n      if (node === null) continue;\n      if (node.metaname === \"Function\") {\n        this.quill.formatText(i, 1, \"color\", \"function\", \"silent\");\n      } else if (node.metaname !== \"Number\" && node.metaname !== \"Vector\") {\n        this.quill.formatText(i, 1, \"color\", \"variable\", \"silent\");\n      }\n    }\n    this.updateCursor();\n  }\n\n  @Watch(\"pen.selection\")\n  updateCursor() {\n    if (this.pen.getIsQuerying()) return;\n\n    this.quill.formatText(\n      0,\n      this.quill.getLength(),\n      \"background\",\n      false,\n      \"silent\"\n    );\n\n    if (this.pen.getSelection()?.attributeId === this.attributeModel.id) {\n      const selection = this.pen.getSelection();\n      this.quill.setSelection(\n        selection.startIndex,\n        selection.endIndex - selection.startIndex,\n        \"silent\"\n      );\n      const length = selection.endIndex - selection.startIndex;\n\n      this.quill.formatText(\n        selection.startIndex,\n        length,\n        \"background\",\n        \"selected\",\n        \"silent\"\n      );\n    }\n  }\n\n  getText() {\n    return Root.pen.getTextForAttribute(this.attributeModel);\n  }\n}\n</script>\n\n<style scoped>\n</style>"]}]}
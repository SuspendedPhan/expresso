{"remainingRequest":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/WasmOrganism.vue?vue&type=script&lang=ts","dependencies":[{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/WasmOrganism.vue","mtime":1714946187073},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js","mtime":1714947394795},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/ts-loader/index.js","mtime":1714947267504},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js","mtime":1714947393584}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB3dSBmcm9tICJ3dSI7CmltcG9ydCBSb290IGZyb20gIi4uL3N0b3JlL1Jvb3QiOwppbXBvcnQgV2FzbUF0dHJpYnV0ZSBmcm9tICIuL1dhc21BdHRyaWJ1dGUudnVlIjsKaW1wb3J0IFJlc2l6ZVNlbnNvciBmcm9tICJjc3MtZWxlbWVudC1xdWVyaWVzL3NyYy9SZXNpemVTZW5zb3IiOwppbXBvcnQgVnVlIGZyb20gInZ1ZSI7CmltcG9ydCBDb21wb25lbnQgZnJvbSAidnVlLWNsYXNzLWNvbXBvbmVudCI7CmltcG9ydCB7UHJvcH0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7CmltcG9ydCB7UHJpbWl0aXZlfSBmcm9tICJAL21vZGVscy9UeXBlIjsKaW1wb3J0IEZ1bmN0aW9ucyBmcm9tICJAL2NvZGUvRnVuY3Rpb25zIjsKCkBDb21wb25lbnQoe2NvbXBvbmVudHM6IHtXYXNtQXR0cmlidXRlOiBXYXNtQXR0cmlidXRlfX0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdhc21PcmdhbmlzbSBleHRlbmRzIFZ1ZSB7CiAgQFByb3AoKSBvcmdhbmlzbSE6IGFueTsKICBAUHJvcCgpIGlzUm9vdCE6IGJvb2xlYW47CiAgQFByb3AoKSBvcmdhbmlzbUxheW91dDsKCiAgYXR0cmlidXRlU3RvcmUgPSBSb290LmF0dHJpYnV0ZVN0b3JlOwogIG1ldGFvcmdhbmlzbUNvbGxlY3Rpb24gPSBSb290Lm1ldGFvcmdhbmlzbUNvbGxlY3Rpb247CiAgc2VsZWN0ZWRQcmltaXRpdmVJZCA9IFJvb3QubWV0YW9yZ2FuaXNtQ29sbGVjdGlvbi5nZXRNZXRhb3JnYW5pc21zKClbMF0uaWQ7CiAgYXR0cmlidXRlTmFtZSA9ICIiOwogIGVkaXRhYmxlQXR0cmlidXRlcyA9IFtdIGFzIGFueVtdOwogIHBvc2l0aW9uID0gewogICAgdG9wOiAwLAogICAgbGVmdDogMCwKICB9OwoKICBuYW1lID0gIiI7CiAgc3Vib3JnYW5pc21zID0gW107CgogIG1vdW50ZWQoKSB7CiAgICBpZiAodGhpcy5vcmdhbmlzbSA9PSBudWxsKSB7CiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHRoaXMuaW5pdCgpLCAyMDApOwogICAgICByZXR1cm47CiAgICB9IGVsc2UgewogICAgICB0aGlzLmluaXQoKTsKICAgIH0KICB9CgogIGRlc3Ryb3llZCgpIHsKICAgIHRoaXMub3JnYW5pc21MYXlvdXQucmVjYWxjdWxhdGUoKTsKICB9CgogIGdldCBzdHlsZSgpIHsKICAgIHJldHVybiBgbGVmdDogJHt0aGlzLnBvc2l0aW9uLmxlZnR9cHg7IHRvcDogJHt0aGlzLnBvc2l0aW9uLnRvcH1weDtgOwogIH0KCiAgc3Bhd24oKSB7CiAgICBjb25zdCBtZXRhb3JnYW5pc20gPSB0aGlzLm1ldGFvcmdhbmlzbUNvbGxlY3Rpb24uZ2V0RnJvbUlkKAogICAgICAgIHRoaXMuc2VsZWN0ZWRQcmltaXRpdmVJZAogICAgKTsKICAgIC8vIGNvbnN0IG9yZ2FuID0gdGhpcy5yb290Lm9yZ2FuaXNtQ29sbGVjdGlvbi5wdXRGcm9tTWV0YSgKICAgIC8vICAgICB0aGlzLnJvb3Qud29yZENvbGxlY3Rpb24uZ2V0UmFuZG9tV29yZCgpLAogICAgLy8gICAgIG1ldGFvcmdhbmlzbQogICAgLy8gKTsKICAgIC8vIHRoaXMucm9vdC5vcmdhbmlzbUNvbGxlY3Rpb24uYWRkQ2hpbGQodGhpcy5vcmdhbmlzbSwgb3JnYW4pOwogICAgLy8gdGhpcy5yb290LnNhdmUoKTsKICB9CgogIGFkZEF0dHJpYnV0ZSgpIHsKICAgIC8vIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPQogICAgLy8gICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9PT0gIiIKICAgIC8vICAgICAgICAgPyB0aGlzLnJvb3Qud29yZENvbGxlY3Rpb24uZ2V0UmFuZG9tV29yZCgpCiAgICAvLyAgICAgICAgIDogdGhpcy5hdHRyaWJ1dGVOYW1lOwogICAgLy8gdGhpcy5yb290LmF0dHJpYnV0ZUNvbGxlY3Rpb24ucHV0RWRpdGFibGUodGhpcy5vcmdhbmlzbSwgYXR0cmlidXRlTmFtZSwgUHJpbWl0aXZlLlVuZGV0ZXJtaW5lZCk7CiAgICAvLyB0aGlzLnJvb3Quc2F2ZSgpOwogIH0KCiAgY2xlYXJTdG9yYWdlKCkgewogICAgLy8gdGhpcy5yb290LmNsZWFyU3RvcmFnZSgpOwogIH0KCiAgcmVtb3ZlT3JnYW5pc20ob3JnYW5pc20pIHsKICAgIC8vIHRoaXMucm9vdC5vcmdhbmlzbUNvbGxlY3Rpb24ucmVtb3ZlKG9yZ2FuaXNtKTsKICAgIC8vIHRoaXMucm9vdC5zYXZlKCk7CiAgfQoKICBpbml0KCkgewogICAgY29uc3QgZWxlbWVudCA9IHRoaXMuJHJlZnNbIm9yZ2FuaXNtIl0gYXMgYW55OwogICAgbmV3IFJlc2l6ZVNlbnNvcihlbGVtZW50LCAoKSA9PiB7CiAgICAgIHRoaXMub3JnYW5pc21MYXlvdXQucmVjYWxjdWxhdGUoKTsKICAgIH0pOwoKICAgIHRoaXMub3JnYW5pc21MYXlvdXQucmVnaXN0ZXJFbGVtZW50KGVsZW1lbnQsIHRoaXMub3JnYW5pc20uZ2V0SWQoKSk7CiAgICB0aGlzLm9yZ2FuaXNtTGF5b3V0CiAgICAgICAgLmdldExvY2FsUG9zaXRpb25PYnNlcnZhYmxlKHRoaXMub3JnYW5pc20uZ2V0SWQoKSkKICAgICAgICAuc3Vic2NyaWJlKChsb2NhbFBvc2l0aW9uKSA9PiB7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uLnRvcCA9IGxvY2FsUG9zaXRpb24udG9wOwogICAgICAgICAgdGhpcy5wb3NpdGlvbi5sZWZ0ID0gbG9jYWxQb3NpdGlvbi5sZWZ0OwogICAgICAgIH0pOwoKICAgIC8vIEF0dHJpYnV0ZS5vbkF0dHJpYnV0ZUNvdW50Q2hhbmdlZC5zdWIoKCkgPT4gewogICAgLy8gICBWdWUuc2V0KHRoaXMsICJlZGl0YWJsZUF0dHJpYnV0ZXMiLCB0aGlzLmdldEVkaXRhYmxlQXR0cmlidXRlcygpKTsKICAgIC8vIH0pOwogICAgLy8gdGhpcy5lZGl0YWJsZUF0dHJpYnV0ZXMgPSB0aGlzLmdldEVkaXRhYmxlQXR0cmlidXRlcygpOwoKICAgIHRoaXMubmFtZSA9IHRoaXMub3JnYW5pc20uZ2V0TmFtZSgpOwogICAgY29uc3QgYXR0cmlidXRlcyA9IEZ1bmN0aW9ucy52ZWN0b3JUb0FycmF5KHRoaXMub3JnYW5pc20uZ2V0QXR0cmlidXRlcygpKQogICAgICAgIC5maWx0ZXIoYXR0cmlidXRlID0+IGF0dHJpYnV0ZS5jb25zdHJ1Y3Rvci5uYW1lID09PSAiRWRpdGFibGVBdHRyaWJ1dGUiKTsKICAgIHRoaXMuZWRpdGFibGVBdHRyaWJ1dGVzID0gYXR0cmlidXRlczsKICB9CgogIGdldE1ldGFuYW1lKG9yZ2FuaXNtKSB7CiAgICByZXR1cm4gJ25vdCBpbXBsZW1lbnRlZCc7CiAgICAvLyByZXR1cm4gdGhpcy5yb290Lm1ldGFvcmdhbmlzbUNvbGxlY3Rpb24uZ2V0RnJvbUlkKG9yZ2FuaXNtLm1ldGFvcmdhbmlzbUlkKS5uYW1lOwogIH0KfQo="},{"version":3,"sources":["WasmOrganism.vue"],"names":[],"mappings":";AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"WasmOrganism.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div v-if=\"organism\" class=\"organism\" ref=\"organism\" :style=\"style\">\n    <div class=\"title-bar\">\n      <div class=\"organism-name\">\n        {{ name }}\n        <!--        ({{ getMetaname(organism) }})-->\n      </div>\n      <button\n          v-if=\"!isRoot\"\n          class=\"button\"\n          @click=\"removeOrganism(organism)\"\n      ></button>\n    </div>\n    <!--    <div class=\"controls\">-->\n    <!--      <select v-model=\"selectedPrimitiveId\">-->\n    <!--        <option-->\n    <!--            v-for=\"metaorganism in metaorganismCollection.getMetaorganisms()\"-->\n    <!--            :key=\"metaorganism.id\"-->\n    <!--            :value=\"metaorganism.id\"-->\n    <!--        >-->\n    <!--          {{ metaorganism.name }}-->\n    <!--        </option>-->\n    <!--      </select>-->\n    <!--      <button @click=\"spawn\">Spawn Suborganism</button>-->\n    <!--      <input placeholder=\"Attribute name\" v-model=\"attributeName\" />-->\n    <!--      <button @click=\"addAttribute\">Add Attribute</button>-->\n    <!--    </div>-->\n    <div class=\"attribute-group\">\n      <div\n          class=\"attribute\"\n          v-for=\"(attribute, index) in editableAttributes\"\n          :key=\"attribute.getId()\"\n      >\n        <div v-if=\"index !== 0\" class=\"divider\"></div>\n        <WasmAttribute :attribute=\"attribute\"/>\n      </div>\n    </div>\n    <WasmOrganism\n        class=\"organ\"\n        v-for=\"suborganism in suborganisms\"\n        :key=\"suborganism\"\n        :organism=\"suborganism\"\n        :isRoot=\"false\"\n        :organismLayout=\"organismLayout\"\n    >\n    </WasmOrganism>\n  </div>\n</template>\n\n<script lang='ts'>\nimport wu from \"wu\";\nimport Root from \"../store/Root\";\nimport WasmAttribute from \"./WasmAttribute.vue\";\nimport ResizeSensor from \"css-element-queries/src/ResizeSensor\";\nimport Vue from \"vue\";\nimport Component from \"vue-class-component\";\nimport {Prop} from \"vue-property-decorator\";\nimport {Primitive} from \"@/models/Type\";\nimport Functions from \"@/code/Functions\";\n\n@Component({components: {WasmAttribute: WasmAttribute}})\nexport default class WasmOrganism extends Vue {\n  @Prop() organism!: any;\n  @Prop() isRoot!: boolean;\n  @Prop() organismLayout;\n\n  attributeStore = Root.attributeStore;\n  metaorganismCollection = Root.metaorganismCollection;\n  selectedPrimitiveId = Root.metaorganismCollection.getMetaorganisms()[0].id;\n  attributeName = \"\";\n  editableAttributes = [] as any[];\n  position = {\n    top: 0,\n    left: 0,\n  };\n\n  name = \"\";\n  suborganisms = [];\n\n  mounted() {\n    if (this.organism == null) {\n      window.setTimeout(() => this.init(), 200);\n      return;\n    } else {\n      this.init();\n    }\n  }\n\n  destroyed() {\n    this.organismLayout.recalculate();\n  }\n\n  get style() {\n    return `left: ${this.position.left}px; top: ${this.position.top}px;`;\n  }\n\n  spawn() {\n    const metaorganism = this.metaorganismCollection.getFromId(\n        this.selectedPrimitiveId\n    );\n    // const organ = this.root.organismCollection.putFromMeta(\n    //     this.root.wordCollection.getRandomWord(),\n    //     metaorganism\n    // );\n    // this.root.organismCollection.addChild(this.organism, organ);\n    // this.root.save();\n  }\n\n  addAttribute() {\n    // const attributeName =\n    //     this.attributeName === \"\"\n    //         ? this.root.wordCollection.getRandomWord()\n    //         : this.attributeName;\n    // this.root.attributeCollection.putEditable(this.organism, attributeName, Primitive.Undetermined);\n    // this.root.save();\n  }\n\n  clearStorage() {\n    // this.root.clearStorage();\n  }\n\n  removeOrganism(organism) {\n    // this.root.organismCollection.remove(organism);\n    // this.root.save();\n  }\n\n  init() {\n    const element = this.$refs[\"organism\"] as any;\n    new ResizeSensor(element, () => {\n      this.organismLayout.recalculate();\n    });\n\n    this.organismLayout.registerElement(element, this.organism.getId());\n    this.organismLayout\n        .getLocalPositionObservable(this.organism.getId())\n        .subscribe((localPosition) => {\n          this.position.top = localPosition.top;\n          this.position.left = localPosition.left;\n        });\n\n    // Attribute.onAttributeCountChanged.sub(() => {\n    //   Vue.set(this, \"editableAttributes\", this.getEditableAttributes());\n    // });\n    // this.editableAttributes = this.getEditableAttributes();\n\n    this.name = this.organism.getName();\n    const attributes = Functions.vectorToArray(this.organism.getAttributes())\n        .filter(attribute => attribute.constructor.name === \"EditableAttribute\");\n    this.editableAttributes = attributes;\n  }\n\n  getMetaname(organism) {\n    return 'not implemented';\n    // return this.root.metaorganismCollection.getFromId(organism.metaorganismId).name;\n  }\n}\n</script>\n\n<style scoped>\n.organism {\n  position: absolute;\n  /* margin-bottom: 20px; */\n  border: 1px solid black;\n  padding-left: 20px;\n  padding-right: 20px;\n  padding-top: 20px;\n  border-radius: 2px;\n  /* margin-top: 10px; */\n  background-color: white;\n}\n\n.controls {\n  display: grid;\n  grid-template-columns: max-content max-content;\n  gap: 10px;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.attribute-group {\n  display: grid;\n  grid-auto-rows: auto;\n  /* gap: 10px; */\n}\n\n.divider {\n  border-bottom: 2px solid rgba(0, 0, 0, 0.2);\n  margin-bottom: 20px;\n  margin-top: 10px;\n}\n\n.organism-name {\n  color: #4dc47d;\n  font-weight: 500;\n  font-size: 24px;\n}\n\n.title-bar {\n  display: flex;\n  justify-content: space-between;\n}\n\n.button {\n  background-image: url(\"/icons/remove.svg\");\n  background-size: 16px 16px;\n  background-repeat: no-repeat;\n  background-position: center;\n  width: 20px;\n  height: 20px;\n  border: none;\n}\n</style>\n"]}]}
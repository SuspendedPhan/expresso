{"remainingRequest":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js!/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/ts-loader/index.js??ref--14-2!/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/eslint-loader/index.js??ref--13-0!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/code/ElementLayout.ts","dependencies":[{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/code/ElementLayout.ts","mtime":1714946187067},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/babel.config.js","mtime":1714946187052},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js","mtime":1714947394795},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/ts-loader/index.js","mtime":1714947267504},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/eslint-loader/index.js","mtime":1714947270651}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAiQC9jb2RlL0xheW91dCI7CmltcG9ydCB7IHNoYXJlIH0gZnJvbSAicnhqcy9vcGVyYXRvcnMiOwppbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAicnhqcyI7CmV4cG9ydCBjbGFzcyBFbGVtZW50TGF5b3V0IHsKICAvLyBnZXRSb290Tm9kZSBpcyBub3QgdXNlZC4KICAvLyBnZXRDaGlsZHJlbiByZWZlcnMgdG8gdGhlIGNoaWxkcmVuIHRoYXQgd2Ugd2lsbCBjYWxsIGdldEtleSgpIG9uLgogIGNvbnN0cnVjdG9yKGdldFJvb3ROb2RlLCBnZXRDaGlsZHJlbiwgZ2V0S2V5ID0gbnVsbCwgaG9yaXpvbnRhbE1hcmdpbiwgdmVydGljYWxNYXJnaW4pIHsKICAgIC8vIG9uQ2FsY3VsYXRlZCBpcyBhIHVzZWZ1bCBldmVudCBmb3IgcmVkcmF3aW5nIHRoZSBjb25uZWN0aW5nIGxpbmVzIGFuZCByZXNpemluZyB0aGUgY29udGFpbmVyLgogICAgdGhpcy5vbkNhbGN1bGF0ZWQgPSBuZXcgT2JzZXJ2YWJsZShzdWJzY3JpYmVyID0+IHRoaXMub25DYWxjdWxhdGVkU3Vic2NyaWJlciA9IHN1YnNjcmliZXIpLnBpcGUoc2hhcmUoKSk7CiAgICB0aGlzLm9uTG9jYWxQb3NpdGlvblN1YnNjcmliZXJCeUVsZW1lbnRJZCA9IG5ldyBNYXAoKTsKICAgIHRoaXMuZWxlbWVudEJ5S2V5ID0gbmV3IE1hcCgpOwogICAgdGhpcy5nZXRLZXkgPSBnZXRLZXkgIT09IG51bGwgJiYgZ2V0S2V5ICE9PSB2b2lkIDAgPyBnZXRLZXkgOiBub2RlID0+IG5vZGUuaWQ7CiAgICB0aGlzLmxheW91dCA9IG5ldyBMYXlvdXQodGhpcy5nZXRXaWR0aC5iaW5kKHRoaXMpLCB0aGlzLmdldEhlaWdodC5iaW5kKHRoaXMpLCBnZXRDaGlsZHJlbiwgdGhpcy5nZXRLZXksIGhvcml6b250YWxNYXJnaW4sIHZlcnRpY2FsTWFyZ2luKTsKICAgIHRoaXMuZ2V0Um9vdE5vZGUgPSBnZXRSb290Tm9kZTsKICB9CiAgcmVjYWxjdWxhdGUoKSB7CiAgICBjb25zdCByb290Tm9kZSA9IHRoaXMuZ2V0Um9vdE5vZGUoKTsKICAgIGNvbnN0IG91dHB1dCA9IHRoaXMubGF5b3V0LmNhbGN1bGF0ZShyb290Tm9kZSk7CiAgICBmb3IgKGNvbnN0IFtlbGVtZW50S2V5LCBsb2NhbFBvc2l0aW9uU3Vic2NyaWJlcl0gb2YgdGhpcy5vbkxvY2FsUG9zaXRpb25TdWJzY3JpYmVyQnlFbGVtZW50SWQuZW50cmllcygpKSB7CiAgICAgIGxvY2FsUG9zaXRpb25TdWJzY3JpYmVyLm5leHQob3V0cHV0LmxvY2FsUG9zaXRpb25zQnlLZXkuZ2V0KGVsZW1lbnRLZXkpKTsKICAgIH0KICAgIGNvbnNvbGUuYXNzZXJ0KHRoaXMub25DYWxjdWxhdGVkU3Vic2NyaWJlciwgIkZhaWxlZCBhc3NlcnRpb24gbWVhbnMgbm9ib2R5IHN1YnNjcmliZWQgeWV0LiIpOwogICAgdGhpcy5vbkNhbGN1bGF0ZWRTdWJzY3JpYmVyLm5leHQob3V0cHV0KTsKICB9CiAgLy8gcmVnaXN0ZXJFbGVtZW50IG11c3QgYmUgY2FsbGVkIHNvIHRoYXQgdGhlIGxheW91dCBrbm93cyBob3cgdG8gZ2V0IHRoZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHlvdXIgZWxlbWVudHMuCiAgcmVnaXN0ZXJFbGVtZW50KGVsZW1lbnQsIGVsZW1lbnRLZXkpIHsKICAgIHRoaXMuZWxlbWVudEJ5S2V5LnNldChlbGVtZW50S2V5LCBlbGVtZW50KTsKICB9CiAgLy8gZ2V0TG9jYWxQb3NpdGlvbk9ic2VydmFibGUgaXMgYSB1c2VmdWwgZXZlbnQgZm9yIHBvc2l0aW9uaW5nIGVhY2ggaW5kaXZpZHVhbCBlbGVtZW50LiBOb3RlIHRoYXQgdGhlc2UgYXJlIGxvY2FsCiAgLy8gcG9zaXRpb25zLCB3aGljaCBtZWFucyBjaGlsZHJlbiBhcmUgcG9zaXRpb25lZCByZWxhdGl2ZSB0byB0aGUgcGFyZW50LiBUaGlzIHdvcmtzIHdlbGwgd2l0aCBuZXN0ZWQgZWxlbWVudHMgdGhhdAogIC8vIGFsbCBoYXZlIHRoZSAicG9zaXRpb246IGFic29sdXRlIiBDU1MgcnVsZS4KICAvLyBXaGVuIHRoZSBldmVudCBpcyBmaXJlZCwgYSBMYXlvdXQuUG9pbnQgb2JqZWN0IGlzIHBhc3NlZC4KICBnZXRMb2NhbFBvc2l0aW9uT2JzZXJ2YWJsZShlbGVtZW50S2V5KSB7CiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoc3Vic2NyaWJlciA9PiB7CiAgICAgIHRoaXMub25Mb2NhbFBvc2l0aW9uU3Vic2NyaWJlckJ5RWxlbWVudElkLnNldChlbGVtZW50S2V5LCBzdWJzY3JpYmVyKTsKICAgIH0pOwogIH0KICBnZXRXaWR0aChub2RlKSB7CiAgICB2YXIgX2VsZW1lbnQkb2Zmc2V0V2lkdGg7CiAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleShub2RlKTsKICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRCeUtleS5nZXQoa2V5KTsKICAgIHJldHVybiAoX2VsZW1lbnQkb2Zmc2V0V2lkdGggPSBlbGVtZW50ID09PSBudWxsIHx8IGVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVsZW1lbnQub2Zmc2V0V2lkdGgpICE9PSBudWxsICYmIF9lbGVtZW50JG9mZnNldFdpZHRoICE9PSB2b2lkIDAgPyBfZWxlbWVudCRvZmZzZXRXaWR0aCA6IDA7CiAgfQogIGdldEhlaWdodChub2RlKSB7CiAgICB2YXIgX2VsZW1lbnQkb2Zmc2V0SGVpZ2h0OwogICAgY29uc29sZS5sb2cobm9kZSk7CiAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleShub2RlKTsKICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRCeUtleS5nZXQoa2V5KTsKICAgIGNvbnN0IGFuc3dlciA9IChfZWxlbWVudCRvZmZzZXRIZWlnaHQgPSBlbGVtZW50ID09PSBudWxsIHx8IGVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVsZW1lbnQub2Zmc2V0SGVpZ2h0KSAhPT0gbnVsbCAmJiBfZWxlbWVudCRvZmZzZXRIZWlnaHQgIT09IHZvaWQgMCA/IF9lbGVtZW50JG9mZnNldEhlaWdodCA6IDA7CiAgICBjb25zb2xlLmxvZyhlbGVtZW50KTsKICAgIGNvbnNvbGUubG9nKGFuc3dlcik7CiAgICByZXR1cm4gYW5zd2VyOwogIH0KfQ=="},{"version":3,"names":["Layout","share","Observable","ElementLayout","constructor","getRootNode","getChildren","getKey","horizontalMargin","verticalMargin","onCalculated","subscriber","onCalculatedSubscriber","pipe","onLocalPositionSubscriberByElementId","Map","elementByKey","node","id","layout","getWidth","bind","getHeight","recalculate","rootNode","output","calculate","elementKey","localPositionSubscriber","entries","next","localPositionsByKey","get","console","assert","registerElement","element","set","getLocalPositionObservable","_element$offsetWidth","key","offsetWidth","_element$offsetHeight","log","answer","offsetHeight"],"sources":["/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/eslint-loader/index.js??ref--13-0!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/code/ElementLayout.ts"],"sourcesContent":["import {Layout, Line, Output, Point} from \"@/code/Layout\";\nimport { Root } from \"../store/Root\";\nimport * as rxjs from \"rxjs\";\nimport { share } from \"rxjs/operators\";\nimport { Observable, Subject } from \"rxjs\";\n\nexport class ElementLayout {\n  private layout;\n\n  private getRootNode;\n\n  // onCalculated is a useful event for redrawing the connecting lines and resizing the container.\n  public onCalculated = new Observable<Output>(\n    (subscriber) => (this.onCalculatedSubscriber = subscriber)\n  ).pipe(share());\n\n\n  private onCalculatedSubscriber;\n\n  private onLocalPositionSubscriberByElementId = new Map<\n    string,\n    rxjs.Subscriber<Point>\n  >();\n  private elementByKey = new Map<string, HTMLElement>();\n\n  private getKey;\n\n\n  // getRootNode is not used.\n  // getChildren refers to the children that we will call getKey() on.\n  constructor(getRootNode, getChildren, getKey: any = null, horizontalMargin: number, verticalMargin: number) {\n    this.getKey = getKey ?? (node => node.id);\n\n    this.layout = new Layout(\n        this.getWidth.bind(this),\n        this.getHeight.bind(this),\n        getChildren,\n        this.getKey,\n        horizontalMargin,\n        verticalMargin,\n    );\n    this.getRootNode = getRootNode;\n  }\n\n  public recalculate() {\n    const rootNode = this.getRootNode();\n    const output = this.layout.calculate(rootNode);\n    for (const [\n      elementKey,\n      localPositionSubscriber,\n    ] of this.onLocalPositionSubscriberByElementId.entries()) {\n      localPositionSubscriber.next(output.localPositionsByKey.get(elementKey));\n    }\n\n    console.assert(\n      this.onCalculatedSubscriber,\n      \"Failed assertion means nobody subscribed yet.\"\n    );\n    this.onCalculatedSubscriber.next(output);\n  }\n\n  // registerElement must be called so that the layout knows how to get the width and height of your elements.\n  public registerElement(element, elementKey) {\n    this.elementByKey.set(elementKey, element);\n  }\n\n  // getLocalPositionObservable is a useful event for positioning each individual element. Note that these are local\n  // positions, which means children are positioned relative to the parent. This works well with nested elements that\n  // all have the \"position: absolute\" CSS rule.\n  // When the event is fired, a Layout.Point object is passed.\n  public getLocalPositionObservable(elementKey) {\n    return new Observable<Point>((subscriber) => {\n      this.onLocalPositionSubscriberByElementId.set(elementKey, subscriber);\n    });\n  }\n\n  private getWidth(node) {\n    const key = this.getKey(node);\n    const element = this.elementByKey.get(key);\n    return element?.offsetWidth ?? 0;\n  }\n\n  private getHeight(node) {\n    console.log(node);\n    const key = this.getKey(node);\n    const element = this.elementByKey.get(key);\n    const answer = element?.offsetHeight ?? 0;\n    console.log(element);\n    console.log(answer);\n    return answer;\n  }\n}\n"],"mappings":"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","ignoreList":[]}]}
{"remainingRequest":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js!/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/ts-loader/index.js??ref--14-2!/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/WasmNode.vue?vue&type=script&lang=ts","dependencies":[{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/WasmNode.vue","mtime":1714946187073},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/babel.config.js","mtime":1714946187052},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/babel-loader/lib/index.js","mtime":1714947394795},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/ts-loader/index.js","mtime":1714947267504},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js","mtime":1714947270264},{"path":"/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js","mtime":1714947393584}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIFdhc21Ob2RlXzE7CmltcG9ydCB7IF9fZGVjb3JhdGUgfSBmcm9tICJ0c2xpYiI7CmltcG9ydCBDb21wb25lbnQgZnJvbSAidnVlLWNsYXNzLWNvbXBvbmVudCI7CmltcG9ydCB7IEluamVjdCwgUHJvcCB9IGZyb20gInZ1ZS1wcm9wZXJ0eS1kZWNvcmF0b3IiOwppbXBvcnQgVnVlIGZyb20gInZ1ZSI7CmltcG9ydCBTZWFyY2hib3ggZnJvbSAiQC9jb21wb25lbnRzL1NlYXJjaGJveC52dWUiOwppbXBvcnQgV2FzbVBlbiBmcm9tICJAL2NvZGUvV2FzbVBlbiI7CmltcG9ydCBTdG9yZSwgeyBTaWJsaW5nUm90YXRpb25EaXJlY3Rpb24gfSBmcm9tICJAL21vZGVscy9TdG9yZSI7CmxldCBXYXNtTm9kZSA9IFdhc21Ob2RlXzEgPSBjbGFzcyBXYXNtTm9kZSBleHRlbmRzIFZ1ZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlciguLi5hcmd1bWVudHMpOwogICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgdGhpcy50ZXh0ID0gJyc7CiAgICB0aGlzLnBvc2l0aW9uID0gewogICAgICB0b3A6IDAsCiAgICAgIGxlZnQ6IDAKICAgIH07CiAgICB0aGlzLm5vZGVDaG9pY2VzID0gW107CiAgICB0aGlzLnNlYXJjaGJveEFjdGl2ZSA9IGZhbHNlOwogICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlOwogICAgdGhpcy5zZWFyY2hib3hRdWVyeSA9ICcnOwogICAgdGhpcy5vblNlbGVjdGVkTm9kZUNoYW5nZWRGdW5jdG9yID0gKCkgPT4gdGhpcy5vblNlbGVjdGVkTm9kZUNoYW5nZWQoKTsKICB9CiAgZ2V0IHN0eWxlKCkgewogICAgcmV0dXJuIGBsZWZ0OiAke3RoaXMucG9zaXRpb24ubGVmdH1weDsgdG9wOiAke3RoaXMucG9zaXRpb24udG9wfXB4O2A7CiAgfQogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMkcGVuJGdldFNlbGVjdGVkOwogICAgY29uc3Qgbm9kZSA9IHRoaXMubm9kZTsKICAgIHRoaXMuY2hpbGRyZW4gPSBXYXNtTm9kZV8xLmdldENoaWxkcmVuKG5vZGUpOwogICAgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ0FkZE9wTm9kZScpIHsKICAgICAgdGhpcy50ZXh0ID0gJ0FkZCc7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ1N1Yk9wTm9kZScpIHsKICAgICAgdGhpcy50ZXh0ID0gJ1N1Yic7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ011bE9wTm9kZScpIHsKICAgICAgdGhpcy50ZXh0ID0gJ011bCc7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ0Rpdk9wTm9kZScpIHsKICAgICAgdGhpcy50ZXh0ID0gJ0Rpdic7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ01vZE9wTm9kZScpIHsKICAgICAgdGhpcy50ZXh0ID0gJ01vZCc7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ051bWJlck5vZGUnKSB7CiAgICAgIHRoaXMudGV4dCA9IG5vZGUuZ2V0VmFsdWUoKTsKICAgIH0gZWxzZSBpZiAobm9kZS5jb25zdHJ1Y3Rvci5uYW1lID09PSAnQXR0cmlidXRlUmVmZXJlbmNlTm9kZScpIHsKICAgICAgdGhpcy50ZXh0ID0gbm9kZS5nZXRSZWZlcmVuY2VSYXcoKS5nZXROYW1lKCk7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ0Z1bmN0aW9uQ2FsbE5vZGUnKSB7CiAgICAgIHRoaXMudGV4dCA9IG5vZGUuZ2V0Q2FsbGVkRnVuY3Rpb24oKS5nZXROYW1lKCk7CiAgICB9IGVsc2UgaWYgKG5vZGUuY29uc3RydWN0b3IubmFtZSA9PT0gJ1BhcmFtZXRlck5vZGUnKSB7CiAgICAgIHRoaXMudGV4dCA9IG5vZGUuZ2V0RnVuY3Rpb25QYXJhbWV0ZXIoKS5nZXROYW1lKCk7CiAgICB9IGVsc2UgewogICAgICBjb25zb2xlLmVycm9yKG5vZGUuY29uc3RydWN0b3IubmFtZSk7CiAgICB9CiAgICB3aW5kb3cud2FzbU1vZHVsZS5FbWJpbmRVdGlsLnNldFNpZ25hbExpc3RlbmVyKG5vZGUuZ2V0T25DaGFuZ2VkU2lnbmFsKCksICgpID0+IHRoaXMub25Ob2RlQ2hhbmdlZCgpKTsKICAgIHRoaXMubm9kZUxheW91dC5yZWdpc3RlckVsZW1lbnQodGhpcy4kcmVmc1snbm9kZSddLCB0aGlzLm5vZGUuZ2V0SWQoKSk7CiAgICB0aGlzLmxvY2FsTGF5b3V0UG9zaXRpb25TdWJzY3JpcHRpb24gPSB0aGlzLm5vZGVMYXlvdXQuZ2V0TG9jYWxQb3NpdGlvbk9ic2VydmFibGUodGhpcy5ub2RlLmdldElkKCkpLnN1YnNjcmliZShsb2NhbFBvc2l0aW9uID0+IHsKICAgICAgaWYgKGxvY2FsUG9zaXRpb24gPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgICB0aGlzLnBvc2l0aW9uLnRvcCA9IGxvY2FsUG9zaXRpb24udG9wOwogICAgICB0aGlzLnBvc2l0aW9uLmxlZnQgPSBsb2NhbFBvc2l0aW9uLmxlZnQ7CiAgICB9KTsKICAgIHRoaXMucGVuLm9uU2VsZWN0ZWROb2RlQ2hhbmdlZC5zdWIodGhpcy5vblNlbGVjdGVkTm9kZUNoYW5nZWRGdW5jdG9yKTsKICAgIHRoaXMub25LZXlkb3duRnVuY3Rpb24gPSBldmVudCA9PiB0aGlzLm9uS2V5ZG93bihldmVudCk7CiAgICAvLyBTZXQgdGltZW91dCwgb3RoZXJ3aXNlIG5vZGUgcmVwbGFjZW1lbnQgd2lsbCBnZXQgdGhlIGVudGVyIGtleSByaWdodCBhd2F5LgogICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gewogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5vbktleWRvd25GdW5jdGlvbik7CiAgICB9LCAwKTsKICAgIC8vIFdlIGV4cGVjdCB0aGUgbm9kZSB3ZSByZXBsYWNlZCB0byBzZXQgdGhlIHBlbidzIHNlbGVjdGVkIG5vZGUgdG8gYmUgb3VyIG5vZGUKICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5ub2RlLmdldElkKCkgPT09ICgoX3RoaXMkcGVuJGdldFNlbGVjdGVkID0gdGhpcy5wZW4uZ2V0U2VsZWN0ZWROb2RlKCkpID09PSBudWxsIHx8IF90aGlzJHBlbiRnZXRTZWxlY3RlZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkcGVuJGdldFNlbGVjdGVkLmdldElkKCkpOwogICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0cnVlOwogICAgfQogIH0KICBvbktleWRvd24oZXZlbnQpIHsKICAgIGlmICghdGhpcy5zZWxlY3RlZCkgcmV0dXJuOwogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgewogICAgICB0aGlzLnNlYXJjaGJveEFjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLiRyZWZzWydzZWFyY2hib3gnXS5mb2N1cygpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMub25LZXlkb3duQXJyb3dzKGV2ZW50KTsKICAgIH0KICB9CiAgb25LZXlkb3duQXJyb3dzKGV2ZW50KSB7CiAgICBpZiAodGhpcy5ub2RlLmdldFBhcmVudCgpID09PSBudWxsKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ29ua2V5ZG93biBnZXQgcGFyZW50IG51bGwnKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgcGFyZW50ID0gdGhpcy5ub2RlLmdldFBhcmVudCgpOwogICAgaWYgKHBhcmVudC5pc05vZGUoKSkgewogICAgICB0aGlzLm9uS2V5ZG93bkRvd24oZXZlbnQpOwogICAgICBjb25zdCBwYXJlbnROb2RlID0gcGFyZW50LmdldE5vZGUoKTsKICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93VXAnKSB7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5wZW4uc2V0U2VsZWN0ZWROb2RlKHBhcmVudE5vZGUpLCAwKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93TGVmdCcpIHsKICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBTdG9yZS5nZXRTaWJsaW5nKHBhcmVudE5vZGUsIHRoaXMubm9kZSwgU2libGluZ1JvdGF0aW9uRGlyZWN0aW9uLkxlZnQpOwogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHRoaXMucGVuLnNldFNlbGVjdGVkTm9kZShzZWxlY3RlZE5vZGUpLCAwKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93UmlnaHQnKSB7CiAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlID0gU3RvcmUuZ2V0U2libGluZyhwYXJlbnROb2RlLCB0aGlzLm5vZGUsIFNpYmxpbmdSb3RhdGlvbkRpcmVjdGlvbi5SaWdodCk7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5wZW4uc2V0U2VsZWN0ZWROb2RlKHNlbGVjdGVkTm9kZSksIDApOwogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAocGFyZW50LmlzQXR0cmlidXRlKCkpIHsKICAgICAgdGhpcy5vbktleWRvd25Eb3duKGV2ZW50KTsKICAgIH0KICB9CiAgb25LZXlkb3duRG93bihldmVudCkgewogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicpIHsKICAgICAgY29uc3QgY2hpbGRyZW4gPSBXYXNtTm9kZV8xLmdldENoaWxkcmVuKHRoaXMubm9kZSk7CiAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5wZW4uc2V0U2VsZWN0ZWROb2RlKGNoaWxkcmVuWzBdKSwgMCk7CiAgICAgIH0KICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgIH0KICB9CiAgZGVzdHJveWVkKCkgewogICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMub25LZXlkb3duRnVuY3Rpb24pOwogICAgdGhpcy5sb2NhbExheW91dFBvc2l0aW9uU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7CiAgICB0aGlzLnBlbi5vblNlbGVjdGVkTm9kZUNoYW5nZWQudW5zdWIodGhpcy5vblNlbGVjdGVkTm9kZUNoYW5nZWRGdW5jdG9yKTsKICB9CiAgb25DbGljaygpIHsKICAgIHRoaXMucGVuLnNldFNlbGVjdGVkTm9kZSh0aGlzLm5vZGUpOwogICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7CiAgICB0aGlzLm5vZGVDaG9pY2VzID0gV2FzbVBlbi5nZXROb2RlQ2hvaWNlcyh0aGlzLm5vZGUsIHRoaXMuc2VhcmNoYm94UXVlcnkpOwogIH0KICBvblNlYXJjaGJveFF1ZXJ5SW5wdXQocXVlcnkpIHsKICAgIHRoaXMuc2VhcmNoYm94UXVlcnkgPSBxdWVyeTsKICAgIHRoaXMubm9kZUNob2ljZXMgPSBXYXNtUGVuLmdldE5vZGVDaG9pY2VzKHRoaXMubm9kZSwgdGhpcy5zZWFyY2hib3hRdWVyeSk7CiAgfQogIG9uU2VhcmNoYm94Qmx1cigpIHsKICAgIHRoaXMuc2VhcmNoYm94QWN0aXZlID0gZmFsc2U7CiAgfQogIG9uU2VhcmNoYm94Q2hvaWNlQ29tbWl0dGVkKGNob2ljZSkgewogICAgY29uc3QgbmV3Tm9kZSA9IGNob2ljZS5ub2RlTWFrZXJGdW5jdGlvbigpOwogICAgdGhpcy5ub2RlLnJlcGxhY2UobmV3Tm9kZSk7CiAgICB0aGlzLnBlbi5zZXRTZWxlY3RlZE5vZGUobmV3Tm9kZSk7CiAgICB0aGlzLnNhdmVTdG9yZUZ1bmN0b3IoKTsKICB9CiAgb25TZWxlY3RlZE5vZGVDaGFuZ2VkKCkgewogICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLnBlbi5zZWxlY3RlZE5vZGUgPT0gbnVsbCA/IGZhbHNlIDogdGhpcy5ub2RlLmVxdWFscyh0aGlzLnBlbi5zZWxlY3RlZE5vZGUpOwogICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlOwogICAgICB0aGlzLnNlYXJjaGJveEFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLm5vZGVDaG9pY2VzID0gW107CiAgICB9CiAgfQogIG9uTm9kZUNoYW5nZWQoKSB7CiAgICB0aGlzLmNoaWxkcmVuID0gV2FzbU5vZGVfMS5nZXRDaGlsZHJlbih0aGlzLm5vZGUpOwogICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy5ub2RlTGF5b3V0LnJlY2FsY3VsYXRlKCkpOwogIH0KICBzdGF0aWMgZ2V0Q2hpbGRyZW4obm9kZSkgewogICAgcmV0dXJuIFN0b3JlLmdldENoaWxkcmVuKG5vZGUpOwogIH0KICBzdGF0aWMgaXNCaW5hcnlPcE5vZGUocGFyZW50UmF3KSB7CiAgICByZXR1cm4gU3RvcmUuaXNCaW5hcnlPcE5vZGUocGFyZW50UmF3KTsKICB9Cn07Cl9fZGVjb3JhdGUoW1Byb3AoKV0sIFdhc21Ob2RlLnByb3RvdHlwZSwgIm5vZGUiLCB2b2lkIDApOwpfX2RlY29yYXRlKFtJbmplY3QoKV0sIFdhc21Ob2RlLnByb3RvdHlwZSwgIm5vZGVMYXlvdXQiLCB2b2lkIDApOwpfX2RlY29yYXRlKFtJbmplY3QoKV0sIFdhc21Ob2RlLnByb3RvdHlwZSwgInBlbiIsIHZvaWQgMCk7Cl9fZGVjb3JhdGUoW0luamVjdCgpXSwgV2FzbU5vZGUucHJvdG90eXBlLCAic2F2ZVN0b3JlRnVuY3RvciIsIHZvaWQgMCk7Cldhc21Ob2RlID0gV2FzbU5vZGVfMSA9IF9fZGVjb3JhdGUoW0NvbXBvbmVudCh7CiAgY29tcG9uZW50czogewogICAgU2VhcmNoYm94CiAgfQp9KV0sIFdhc21Ob2RlKTsKZXhwb3J0IGRlZmF1bHQgV2FzbU5vZGU7"},{"version":3,"names":["Component","Inject","Prop","Vue","Searchbox","WasmPen","Store","SiblingRotationDirection","WasmNode","WasmNode_1","constructor","children","text","position","top","left","nodeChoices","searchboxActive","selected","searchboxQuery","onSelectedNodeChangedFunctor","onSelectedNodeChanged","style","mounted","_this$pen$getSelected","node","getChildren","name","getValue","getReferenceRaw","getName","getCalledFunction","getFunctionParameter","console","error","window","wasmModule","EmbindUtil","setSignalListener","getOnChangedSignal","onNodeChanged","nodeLayout","registerElement","$refs","getId","localLayoutPositionSubscription","getLocalPositionObservable","subscribe","localPosition","undefined","pen","sub","onKeydownFunction","event","onKeydown","setTimeout","document","addEventListener","getSelectedNode","key","$nextTick","focus","onKeydownArrows","getParent","parent","isNode","onKeydownDown","parentNode","getNode","setSelectedNode","preventDefault","selectedNode","getSibling","Left","Right","isAttribute","length","destroyed","removeEventListener","unsubscribe","unsub","onClick","getNodeChoices","onSearchboxQueryInput","query","onSearchboxBlur","onSearchboxChoiceCommitted","choice","newNode","nodeMakerFunction","replace","saveStoreFunctor","equals","recalculate","isBinaryOpNode","parentRaw","__decorate","components"],"sources":["/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dylan.phan/stuff/expr-explorations/expresso/js/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dylan.phan/stuff/expr-explorations/expresso/js/src/components/WasmNode.vue?vue&type=script&lang=ts"],"sourcesContent":["\n\nimport Component from \"vue-class-component\";\nimport {Inject, Prop} from \"vue-property-decorator\";\nimport Vue from \"vue\";\nimport Searchbox from \"@/components/Searchbox.vue\";\nimport WasmPen from \"@/code/WasmPen\";\nimport {Subscription} from \"rxjs\";\nimport Store, {SiblingRotationDirection} from \"@/models/Store\";\n\n@Component({\n  components: {Searchbox}\n})\nexport default class WasmNode extends Vue {\n  @Prop() node;\n  @Inject() nodeLayout;\n  @Inject() pen;\n  @Inject() saveStoreFunctor;\n\n  children = [] as any;\n  text = ''\n  position = {\n    top: 0,\n    left: 0,\n  };\n  nodeChoices = [];\n  searchboxActive = false;\n  selected = false;\n  onKeydownFunction;\n  searchboxQuery = '';\n  localLayoutPositionSubscription!: Subscription;\n\n  private onSelectedNodeChangedFunctor = () => this.onSelectedNodeChanged();\n\n  get style() {\n    return `left: ${this.position.left}px; top: ${this.position.top}px;`;\n  }\n\n  async mounted() {\n    const node = this.node;\n    this.children = WasmNode.getChildren(node);\n\n    if (node.constructor.name === 'AddOpNode') {\n      this.text = 'Add';\n    } else if (node.constructor.name === 'SubOpNode') {\n      this.text = 'Sub';\n    } else if (node.constructor.name === 'MulOpNode') {\n      this.text = 'Mul';\n    } else if (node.constructor.name === 'DivOpNode') {\n      this.text = 'Div';\n    } else if (node.constructor.name === 'ModOpNode') {\n      this.text = 'Mod';\n    } else if (node.constructor.name === 'NumberNode') {\n      this.text = node.getValue();\n    } else if (node.constructor.name === 'AttributeReferenceNode') {\n      this.text = node.getReferenceRaw().getName();\n    } else if (node.constructor.name === 'FunctionCallNode') {\n      this.text = node.getCalledFunction().getName();\n    } else if (node.constructor.name === 'ParameterNode') {\n      this.text = node.getFunctionParameter().getName();\n    } else {\n      console.error(node.constructor.name);\n    }\n\n    (window as any).wasmModule.EmbindUtil.setSignalListener(node.getOnChangedSignal(), () => this.onNodeChanged());\n\n    this.nodeLayout.registerElement(this.$refs['node'], this.node.getId());\n    this.localLayoutPositionSubscription = this.nodeLayout\n        .getLocalPositionObservable(this.node.getId())\n        .subscribe((localPosition) => {\n          if (localPosition === undefined) return;\n          this.position.top = localPosition.top;\n          this.position.left = localPosition.left;\n        });\n    this.pen.onSelectedNodeChanged.sub(this.onSelectedNodeChangedFunctor);\n\n    this.onKeydownFunction = event => this.onKeydown(event);\n\n    // Set timeout, otherwise node replacement will get the enter key right away.\n    window.setTimeout(() => {\n      document.addEventListener('keydown', this.onKeydownFunction);\n    }, 0);\n\n    // We expect the node we replaced to set the pen's selected node to be our node\n    const selected = this.node.getId() === this.pen.getSelectedNode()?.getId();\n    if (selected) {\n      this.selected = true;\n    }\n  }\n\n  private onKeydown(event) {\n    if (!this.selected) return;\n\n    if (event.key === 'Enter') {\n      this.searchboxActive = true;\n      this.$nextTick(() => {\n        (this.$refs['searchbox'] as any).focus();\n      });\n    } else {\n      this.onKeydownArrows(event);\n    }\n  }\n\n  private onKeydownArrows(event) {\n    if (this.node.getParent() === null) {\n      console.error('onkeydown get parent null');\n      return;\n    }\n\n    const parent = this.node.getParent();\n    if (parent.isNode()) {\n      this.onKeydownDown(event);\n      const parentNode = parent.getNode();\n      if (event.key === 'ArrowUp') {\n        window.setTimeout(() => this.pen.setSelectedNode(parentNode), 0);\n        event.preventDefault();\n      } else if (event.key === 'ArrowLeft') {\n        const selectedNode = Store.getSibling(parentNode, this.node, SiblingRotationDirection.Left);\n        window.setTimeout(() => this.pen.setSelectedNode(selectedNode), 0);\n        event.preventDefault();\n      } else if (event.key === 'ArrowRight') {\n        const selectedNode = Store.getSibling(parentNode, this.node, SiblingRotationDirection.Right);\n        window.setTimeout(() => this.pen.setSelectedNode(selectedNode), 0);\n        event.preventDefault();\n      }\n    } else if (parent.isAttribute()) {\n      this.onKeydownDown(event);\n    }\n  }\n\n  private onKeydownDown(event) {\n    if (event.key === 'ArrowDown') {\n      const children = WasmNode.getChildren(this.node);\n      if (children.length > 0) {\n        window.setTimeout(() => this.pen.setSelectedNode(children[0]), 0);\n      }\n      event.preventDefault();\n    }\n  }\n\n  destroyed() {\n    document.removeEventListener('keydown', this.onKeydownFunction);\n    this.localLayoutPositionSubscription.unsubscribe();\n    this.pen.onSelectedNodeChanged.unsub(this.onSelectedNodeChangedFunctor);\n  }\n\n  private onClick() {\n    this.pen.setSelectedNode(this.node);\n    this.selected = true;\n    this.nodeChoices = WasmPen.getNodeChoices(this.node, this.searchboxQuery);\n  }\n\n  private onSearchboxQueryInput(query) {\n    this.searchboxQuery = query;\n    this.nodeChoices = WasmPen.getNodeChoices(this.node, this.searchboxQuery);\n  }\n\n  private onSearchboxBlur() {\n    this.searchboxActive = false;\n  }\n\n  private onSearchboxChoiceCommitted(choice) {\n    const newNode = choice.nodeMakerFunction();\n    this.node.replace(newNode);\n    this.pen.setSelectedNode(newNode);\n    this.saveStoreFunctor();\n  }\n\n  private onSelectedNodeChanged() {\n    const selected = this.pen.selectedNode == null ? false : this.node.equals(this.pen.selectedNode);\n    if (selected) {\n      this.selected = true;\n    } else {\n      this.selected = false;\n      this.searchboxActive = false;\n      this.nodeChoices = [];\n    }\n  }\n\n  private onNodeChanged() {\n    this.children = WasmNode.getChildren(this.node);\n    this.$nextTick(() => this.nodeLayout.recalculate());\n  }\n\n  public static getChildren(node) {\n    return Store.getChildren(node);\n  }\n\n  private static isBinaryOpNode(parentRaw) {\n    return Store.isBinaryOpNode(parentRaw);\n  }\n}\n\n"],"mappings":"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","ignoreList":[]}]}